/******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, {
/******/ 				configurable: false,
/******/ 				enumerable: true,
/******/ 				get: getter
/******/ 			});
/******/ 		}
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = 0);
/******/ })
/************************************************************************/
/******/ ([
/* 0 */
/***/ (function(module, exports, __webpack_require__) {

__webpack_require__(1);
var datePrice = __webpack_require__(2);
var dateJson = {
    0: '周一',
    1: '周二',
    2: '周三',
    3: '周四',
    4: '周五',
    5: '周六',
    6: '周日'
}

//设置cookie
function setCookie(name, value, time) {
    var oDate = new Date();
    oDate.setTime(oDate.getTime() + time);
    document.cookie = name + '=' + encodeURIComponent(value) + ';expires=' + oDate.toUTCString();
}

function urlKey(name) {
    var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)");
    var r = window.location.search.substr(1).match(reg);
    if (r != null) return unescape(r[2]); return null;
}

function getDatePrice(m, y, price) {

    var dateArr = datePrice(m, y),
        len = dateArr.length,
        html = '',
        keyNum = 0;

    for (var i = 0; i < len; i++) {
        html += '<tr>';
        for (var j = 0; j < dateArr[i].length; j++) {
            if (dateArr[i][j].num) {
                keyNum++;
                if (price[keyNum] == '') {
                    html += '<td class="disabled"><p>' + dateArr[i][j].num + '</p></td>';
                } else {
                    html += '<td class="js_choose" data-gotime=' + price[keyNum].p_date + '><p>' + dateArr[i][j].num + '</p>' +
                        '<p class="date-price">￥<span class="ticket-pri">' + price[keyNum].p_my_price + '</span></p>';

                    if (price[keyNum].p_kc == '-1' || price[keyNum].p_kc == null) {
                        html += '<p class="date-kc">余:999</p></td>';
                    } else {
                        html += '<p class="date-kc">余:<span class="kc">' + price[keyNum].p_ck + '</span></p></td>';
                    }
                }
            } else {
                html += '<td></td>';
            }
        }
        html += '</tr>';
    }

    $('#priceDay').html(html);
    priceMonth.text(m);
    priceYear.text(y);
}

function pageRender(data) {

    var img = data.t_tick_file,
        len = img.length,
        html = '';

    picShow.css('background', 'url(' + data.t_tick_file[0].src + ') center no-repeat');

    for (var i = 0; i < len; i++) {
        html += '<li class="pic-item"><img class="item-pic" src=' + img[i].src + '></li>';
    }
    $('#picList').html(html);

    //销量
    $('#sales').html('销量: ' + data.t_tick_sell);

    var prevMonthBtn = $('#prevMonthBtn'),
        nextMonthBtn = $('#nextMonthBtn');

    //商品品类
    $('#proCity').html(data.t_tick_city);
    //商品ID
    $('#proID').html(data.t_code);
    //产品名字
    $('#proName').text(data.t_tick_name + '+' + data.t_tick_cat + '+' + data.t_tick_spot);


    //上个月
    prevMonthBtn.click(function (e) {

        if (priceNum == 0) {
            $(this).css('background', '#cecece');
            return false;
        }

        nextMonthBtn.css('background', '#3385ff');

        month -= 1;

        if (month == 0) {
            month = 12;
            year -= 1;
        };
        getDatePrice(month, year, priceData[priceNum - 1]);

        priceNum--;

        if (priceNum == 0) {
            $(this).css('background', '#cecece');
        }
    }).bind("selectstart", function () { return false; });

    //下个月
    nextMonthBtn.click(function (e) {

        if (priceNum == priceLen - 1) {
            return false;
        }

        prevMonthBtn.css('background', '#3385ff');

        month += 1;

        if (month == 13) {
            month = 1;
            year += 1;
        };
        getDatePrice(month, year, priceData[priceNum + 1]);

        priceNum++;

        if (priceNum == priceLen - 1) {
            $(this).css('background', '#cecece');
        }
    }).bind("selectstart", function () { return false; });


    //费用说明
    var fyHtml = '<p class="main-title">费用包含<p>';
    for (var i = 0; i < data.t_tick_cost.length; i++) {

        fyHtml += '<p><span class="费用包含"></span>' +
            '<span class="title">' + data.t_tick_cost[i].name + ' : </span><span>' + data.t_tick_cost[i].num + data.t_tick_cost[i].danwei + ' , 单次时长' + data.t_tick_cost[i].duration + '</span>';

    }
    fyHtml += '</p>';

    if (data.t_another_cost) {
        fyHtml += '<p><span class="title">费用包含补充说明 : </span><span>' + data.t_another_cost + '</span></p>';
    }

    if (data.t_tick_insurance != '0') {
        fyHtml += '<p><span class="title">保险 : </span><span>包含</span></p>';
    }

    fyHtml += '<p class="main-title">费用不包含<p>';

    if (data.t_tick_no_contain) {
        fyHtml += '<p><span class="title">费用不包含 : </span><span>' + data.t_tick_no_contain + '</span></p>';
    }

    if (data.t_tick_insurance == '0') {
        fyHtml += '<p><span class="title">保险 : </span><span>不包含</span></p>';
    }

    $('#feiyongContent').html(fyHtml);

    var ydHtml = '';

    if (data.t_tick_mobile == '1') {
        ydHtml += '<p><span class="title">联系人信息 : </span>需要</p>';
    }

    if (data.t_tick_playerInfo.val == '1') {
        ydHtml += '<p><span class="title">游玩人信息 : </span>只需要1位游玩人信息</p>';
    } else if (data.t_tick_playerInfo.val == '2') {
        ydHtml += '<p><span class="title">游玩人信息 : </span>需要全部游玩人信息</p>';
    }

    if (data.t_tick_pre_book_time.val == '1') {
        ydHtml += '<p><span class="title">提前购买时间 : </span><span>用户需提前' + data.t_tick_pre_book_time.two.hour.val + '小时' + data.t_tick_pre_book_time.two.minute.val + '分预定</span></p>';
    } else if (data.t_tick_pre_book_time.val == '2') {
        ydHtml += '<p><span class="title">提前购买时间 : </span><span>用户需在游玩' + data.t_tick_pre_book_time.three.day.val + data.t_tick_pre_book_time.three.hour.val + '点' + data.t_tick_pre_book_time.three.minute + '分预定</span></p>'
    }

    if (data.t_yd_num) {
        ydHtml += '<p><span class="title">预定数量限制 : </span>每笔订单最少购买' + data.t_yd_num.min + '张';

        if (data.t_yd_num.max) {
            ydHtml += ',最大购买' + data.t_yd_num.max + '张</p>';
        } else {
            ydHtml += '</p>';
        }
    }

    if (data.t_tick_identity.maxNum) {
        ydHtml += '<p><span class="title">身份证限制 : </span>同一身份证在' + minDay + '天内最多购买' + maxNum + '张</p>';
    }

    if (data.t_go_b_time[0].fromH) {
        ydHtml += '<p><span class="title">入园时间 : </span>' + data.t_go_b_time[0].fromH + ':' + data.t_go_b_time[0].fromM + '~' + data.t_go_b_time[0].toH + ':' + data.t_go_b_time[0].toM;
        if (data.t_go_b_time[0].bcInfo.val) {
            ydHtml += ' <span> ' + data.t_go_b_time[0].bcInfo.val + '</span>';
        } else {
            ydHtml += '</p>';
        }
    }

    if (data.t_tick_use_address) {
        ydHtml += '<p><span class="title">入园地址 : </span>';

        for (var i = 0; i < data.t_tick_use_address.length; i++) {
            ydHtml += '<span>' + data.t_tick_use_address[i].val + ' </span>';
        }

        ydHtml += '</p>';
    }

    if (data.t_tick_date == '1') {
        ydHtml += '<p><span class="title">有效期模式 : </span>此门票无需用户指定使用日期</p>';

        ydHtml += '<p><span class="title">有效期 : </span><span>' + data.t_tick_verify_time + '~' + data.t_tick_xj_time + '</span></p>';
    }

    if (data.use_time) {

        ydHtml += '<p><span class="title">可用日期 :</span>';
        for (var i = 0; i < data.use_time.length; i++) {
            if (data.use_time[i] == 'true') {
                ydHtml += '<span> ' + dateJson[i] + ' </span>';
            }
        }
    }

    if (data.no_use_time) {
        ydHtml += '<p><span class="title">不可用日期 :</span>';
        for (var i = 0; i < data.no_use_time.length; i++) {
            ydHtml += '<span> ' + data.no_use_time[i] + ' </span>';
        }
    }

    $('#yudingContent').html(ydHtml);
}

var proPrice = $('#proPrice'),
    NUM = $('#num'),
    PRICE,    //价格
    KC,       //库存
    numVal = 1;   //数量
//增加
$('#chooseNum').on('click', '.add', function () {
    
    var price = proPrice.text();

    if(price == '--'){
        alert('请先选择出游日期');
    }else{
        var num = $(this).parents('.amount').find('.num');
        numVal = +num.text();

        if(numVal == KC){
            Alert('已达到库存上限');
        }

        numVal += 1;
        num.text(numVal);

        price = +PRICE * 100;
        proPrice.text(numVal * price / 100);
    }

}).bind("selectstart", function () { return false; });

$('#chooseNum').on('click', '.red', function () {
    
    var price = proPrice.text();

    if(price == '--'){
        alert('请先选择出游日期');
    }else{
        var num = $(this).parents('.amount').find('.num');
        numVal = +num.text();
        
        if(numVal == 1){
            return false;
        }

        numVal -= 1;
        num.text(numVal);

        price = +PRICE * 100;
        proPrice.text(numVal * price / 100);
    }

}).bind("selectstart", function () { return false; });

var nowDate = new Date(),
    year = nowDate.getFullYear(),
    month = nowDate.getMonth() + 1,
    priceMonth = $('#priceMonth'),
    priceYear = $('#priceYear'),
    picShow = $('#picShow'),
    priceData,
    priceLen,
    priceNum = 0,
    name,
    userId,
    mess,     // =2 需要全部游客信息
    oneIdentify,
    useDate;   //是否是有效期模式

var type = urlKey('type'),
    code = urlKey('code'),
    URL = 'http://www.suiyiyou.net/index.php/Weixin/Detail/detail';

$.ajax({
    url: URL,
    data: {
        type: type,
        code: code
    },
    success: function (res) {

        var data = res.data;
        name = data.t_tick_name + '+' + data.t_tick_cat + '+' + data.t_tick_spot;
        userId = data.t_user_id;
        priceData = res.data.date;
        priceLen = priceData.length;
        mess = data.t_tick_playerInfo.val; //其他游客身份数组
        oneIdentify = data.t_tick_mobile;  //需要一个身份信息1 不需要0
        if (data.t_tick_date == '1') {       //如果是有效期模式
            useDate = {
                use: data.t_tick_date,
                limit: data.t_tick_verify_time + '~' + data.t_tick_xj_time,
                time: data.use_time
            };
            if (data.no_use_time) {
                useDate.no = data.no_use_time
            }
        }
        getDatePrice(month, year, priceData[0]);  //价格日历
        pageRender(data);
    }
})


$('#picList').on('mouseover', '.pic-item', function () {
    var src = $(this).find('.item-pic').attr('src');
    picShow.css('background', 'url(' + src + ') center no-repeat');
})


//价格日历选择
var priceBox = $('#proPrice'),
    goTime = $('#goTime');

$('#priceDay').on('click', '.js_choose', function () {
    $('.js_choose').removeClass('on');
    $(this).addClass('on');

    var price = $(this).find('.ticket-pri').text();
    priceBox.text(price);
    PRICE = +price;
    proPrice.text(PRICE * +NUM.text());

    KC = +$(this).find('.date-kc').text();

    var gotime = $(this).attr('data-gotime');
    goTime.text(gotime);

})


//立即购买
$('#nowBuy').click(function () {
    loginConfirm();
})

function loginConfirm() {
    if ($('#proPrice').text() == '--') {
        alert('请先从价格日历选择日期');
        return false;
    } else {
        code = urlKey('code');
        type = urlKey('type');

        setCookie('price', $('#proPrice').text(), 30 * 60 * 1000);  //价格
        if (useDate) {
            setCookie('use', JSON.stringify(useDate), 30 * 60 * 1000);     //有效期模式
        }
        setCookie('date', $('#goTime').text(), 30 * 60 * 1000);    //出行时间
        setCookie('user', userId, 30 * 60 * 1000);                  
        setCookie('mess', mess, 30 * 60 * 1000);                    //是否需要身份证
        setCookie('num', numVal, 30 * 60 * 1000);
        setCookie('pic', $('.item-pic').eq(0).attr('src'), 30 * 60 * 1000);  //图片首图
        HREF = controller + '/d_ticket?code=' + code + '&type=' + type;

        location.href = HREF;
        setCookie('name', name, 30 * 60 * 1000);  //产品名字
    }
    // $.ajax({
    //     url: 'http://www.suiyiyou.net/index.php/Weixin/BaseLogin/logined',
    //     type: 'POST',
    //     success: function (res) {
    //         var code = res.code;
    //         // if (code == 200) {

    //         code = urlKey('code');
    //         type = urlKey('type');
    //         var chooseOn = $('.js_choose.on'),
    //             kc = chooseOn.find('.kc').text();

    //         setCookie('price', $('#proPrice').text(), 30 * 60 * 1000);  //价格
    //         if (useDate) {
    //             setCookie('use', JSON.stringify(useDate), 30 * 60 * 1000);     //有效期模式
    //         }
    //         setCookie('date', $('#goTime').text(), 30 * 60 * 1000);
    //         setCookie('user', userId, 30 * 60 * 1000);
    //         setCookie('mess', mess, 30 * 60 * 1000);
    //         HREF = controller + '/d_ticket?code=' + code + '&type=' + type;

    //         location.href = HREF;
    //         setCookie('name', name, 30 * 60 * 1000);  //产品名字

    //         // } else {
    //         // location.href = controller + '/register';     //未注册跳转注册
    //         // }
    //     }
    // })
}




/***/ }),
/* 1 */
/***/ (function(module, exports) {

// removed by extract-text-webpack-plugin

/***/ }),
/* 2 */
/***/ (function(module, exports, __webpack_require__) {

var datePrice = {

    getMonthFirstDay : function(m, y) {
        var d = new Date(y, m, 1);
        return d.getDay();
    },

    getMonthTotalDate : function(m, y) {
        var d = new Date(y, m, 0);
        return d.getDate();
    },

    getFromTodayDays : function(d, m, y) {
        var ret;
        var t = new Date();
        var t1 = new Date();
        t.setFullYear(y);
        t.setMonth(m);
        t.setDate(d);
        var days = Math.floor((t.getTime() - t1.getTime()) / (24 * 60 * 60 * 1000));
        var ret = '今天';
        if (days == 0) {
            ret = '今天';
        }
        else if (days == 1) {
            ret = '明天';
        }
        else if (days == 1) {
            ret = '昨天';
        }
        else if (days > 1) {
            ret = days + '天后';
        }
        else if (days < -1) {
            ret = 0 - days + '天前';
        }
        return ret;
    },

    dataPriceArr : function(m, y) {
        var t = new Date();
        var nSpace = datePrice.getMonthFirstDay(m - 1, y);
        var totalDate = datePrice.getMonthTotalDate(m, y);
        var ret = [];
        var trArray = [];
    
        for (var i = 1; ; i++) {
            if (i <= nSpace) {
                trArray.push('');
            }
            else if (i <= totalDate + nSpace) {
    
                trArray.push({
                    num: i - nSpace,
                    isShowDayInfo: false,
                    isToday: (m == t.getMonth() + 1 && i - nSpace == t.getDate() && y == t.getFullYear()) ? true : false,
                });
            }
            else {
                var l = trArray.length;
                for (var j = 0; j + l < 7; j++) {
                    trArray.push('');
                }
                ret.push(trArray);
                break;
            }
            if (trArray.length == 7) {
                ret.push(trArray);
                trArray = [];
            }
        }
        return ret;
    }
};

if (true) {
    module.exports = datePrice.dataPriceArr;
} else {
    window.datePrice = datePrice.dataPriceArr;
}

/***/ })
/******/ ]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAgNmUwZmNhNmRjYTdmMzQ3OWNhYzYiLCJ3ZWJwYWNrOi8vLy4vc3JjL3BfdGlja2V0L2luZGV4LmpzIiwid2VicGFjazovLy8uL3NyYy9wX3RpY2tldC9pbmRleC5zY3NzIiwid2VicGFjazovLy8uLi9jb21tb24vZGF0ZS5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQUs7QUFDTDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLG1DQUEyQiwwQkFBMEIsRUFBRTtBQUN2RCx5Q0FBaUMsZUFBZTtBQUNoRDtBQUNBO0FBQ0E7O0FBRUE7QUFDQSw4REFBc0QsK0RBQStEOztBQUVySDtBQUNBOztBQUVBO0FBQ0E7Ozs7Ozs7QUM3REE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlFQUFpRTtBQUNqRTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSx5Q0FBeUM7QUFDekM7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsbUJBQW1CLFNBQVM7QUFDNUI7QUFDQSx1QkFBdUIsdUJBQXVCO0FBQzlDO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUEsbUJB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QjtBQUNuQiwyREFBMkQ7QUFDM0Q7QUFDQTtBQUNBLFFBQVE7QUFDUjs7Ozs7Ozs7O0FDOWFBLHlDOzs7Ozs7QUNBQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxLQUFLOztBQUVMO0FBQ0E7QUFDQTtBQUNBLEtBQUs7O0FBRUw7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLOztBQUVMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSx1QkFBdUIsRUFBRTtBQUN6QjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQSwrQkFBK0IsV0FBVztBQUMxQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0EsQyIsImZpbGUiOiJwX3RpY2tldC5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIgXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuXG4gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXG4gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSkge1xuIFx0XHRcdHJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzO1xuIFx0XHR9XG4gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcbiBcdFx0XHRpOiBtb2R1bGVJZCxcbiBcdFx0XHRsOiBmYWxzZSxcbiBcdFx0XHRleHBvcnRzOiB7fVxuIFx0XHR9O1xuXG4gXHRcdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuIFx0XHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG4gXHRcdG1vZHVsZS5sID0gdHJ1ZTtcblxuIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4gXHR9XG5cblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuXG4gXHQvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9uIGZvciBoYXJtb255IGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uZCA9IGZ1bmN0aW9uKGV4cG9ydHMsIG5hbWUsIGdldHRlcikge1xuIFx0XHRpZighX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIG5hbWUpKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIG5hbWUsIHtcbiBcdFx0XHRcdGNvbmZpZ3VyYWJsZTogZmFsc2UsXG4gXHRcdFx0XHRlbnVtZXJhYmxlOiB0cnVlLFxuIFx0XHRcdFx0Z2V0OiBnZXR0ZXJcbiBcdFx0XHR9KTtcbiBcdFx0fVxuIFx0fTtcblxuIFx0Ly8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuIFx0XHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cbiBcdFx0XHRmdW5jdGlvbiBnZXREZWZhdWx0KCkgeyByZXR1cm4gbW9kdWxlWydkZWZhdWx0J107IH0gOlxuIFx0XHRcdGZ1bmN0aW9uIGdldE1vZHVsZUV4cG9ydHMoKSB7IHJldHVybiBtb2R1bGU7IH07XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsICdhJywgZ2V0dGVyKTtcbiBcdFx0cmV0dXJuIGdldHRlcjtcbiBcdH07XG5cbiBcdC8vIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbFxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqZWN0LCBwcm9wZXJ0eSkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpOyB9O1xuXG4gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcblxuIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXyhfX3dlYnBhY2tfcmVxdWlyZV9fLnMgPSAwKTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyB3ZWJwYWNrL2Jvb3RzdHJhcCA2ZTBmY2E2ZGNhN2YzNDc5Y2FjNiIsInJlcXVpcmUoJy4vaW5kZXguc2NzcycpO1xyXG52YXIgZGF0ZVByaWNlID0gcmVxdWlyZSgnQ09NTU9OL2RhdGUuanMnKTtcclxudmFyIGRhdGVKc29uID0ge1xyXG4gICAgMDogJ+WRqOS4gCcsXHJcbiAgICAxOiAn5ZGo5LqMJyxcclxuICAgIDI6ICflkajkuIknLFxyXG4gICAgMzogJ+WRqOWbmycsXHJcbiAgICA0OiAn5ZGo5LqUJyxcclxuICAgIDU6ICflkajlha0nLFxyXG4gICAgNjogJ+WRqOaXpSdcclxufVxyXG5cclxuLy/orr7nva5jb29raWVcclxuZnVuY3Rpb24gc2V0Q29va2llKG5hbWUsIHZhbHVlLCB0aW1lKSB7XHJcbiAgICB2YXIgb0RhdGUgPSBuZXcgRGF0ZSgpO1xyXG4gICAgb0RhdGUuc2V0VGltZShvRGF0ZS5nZXRUaW1lKCkgKyB0aW1lKTtcclxuICAgIGRvY3VtZW50LmNvb2tpZSA9IG5hbWUgKyAnPScgKyBlbmNvZGVVUklDb21wb25lbnQodmFsdWUpICsgJztleHBpcmVzPScgKyBvRGF0ZS50b1VUQ1N0cmluZygpO1xyXG59XHJcblxyXG5mdW5jdGlvbiB1cmxLZXkobmFtZSkge1xyXG4gICAgdmFyIHJlZyA9IG5ldyBSZWdFeHAoXCIoXnwmKVwiICsgbmFtZSArIFwiPShbXiZdKikoJnwkKVwiKTtcclxuICAgIHZhciByID0gd2luZG93LmxvY2F0aW9uLnNlYXJjaC5zdWJzdHIoMSkubWF0Y2gocmVnKTtcclxuICAgIGlmIChyICE9IG51bGwpIHJldHVybiB1bmVzY2FwZShyWzJdKTsgcmV0dXJuIG51bGw7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGdldERhdGVQcmljZShtLCB5LCBwcmljZSkge1xyXG5cclxuICAgIHZhciBkYXRlQXJyID0gZGF0ZVByaWNlKG0sIHkpLFxyXG4gICAgICAgIGxlbiA9IGRhdGVBcnIubGVuZ3RoLFxyXG4gICAgICAgIGh0bWwgPSAnJyxcclxuICAgICAgICBrZXlOdW0gPSAwO1xyXG5cclxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuOyBpKyspIHtcclxuICAgICAgICBodG1sICs9ICc8dHI+JztcclxuICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IGRhdGVBcnJbaV0ubGVuZ3RoOyBqKyspIHtcclxuICAgICAgICAgICAgaWYgKGRhdGVBcnJbaV1bal0ubnVtKSB7XHJcbiAgICAgICAgICAgICAgICBrZXlOdW0rKztcclxuICAgICAgICAgICAgICAgIGlmIChwcmljZVtrZXlOdW1dID09ICcnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaHRtbCArPSAnPHRkIGNsYXNzPVwiZGlzYWJsZWRcIj48cD4nICsgZGF0ZUFycltpXVtqXS5udW0gKyAnPC9wPjwvdGQ+JztcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaHRtbCArPSAnPHRkIGNsYXNzPVwianNfY2hvb3NlXCIgZGF0YS1nb3RpbWU9JyArIHByaWNlW2tleU51bV0ucF9kYXRlICsgJz48cD4nICsgZGF0ZUFycltpXVtqXS5udW0gKyAnPC9wPicgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAnPHAgY2xhc3M9XCJkYXRlLXByaWNlXCI+77+lPHNwYW4gY2xhc3M9XCJ0aWNrZXQtcHJpXCI+JyArIHByaWNlW2tleU51bV0ucF9teV9wcmljZSArICc8L3NwYW4+PC9wPic7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChwcmljZVtrZXlOdW1dLnBfa2MgPT0gJy0xJyB8fCBwcmljZVtrZXlOdW1dLnBfa2MgPT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBodG1sICs9ICc8cCBjbGFzcz1cImRhdGUta2NcIj7kvZk6OTk5PC9wPjwvdGQ+JztcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBodG1sICs9ICc8cCBjbGFzcz1cImRhdGUta2NcIj7kvZk6PHNwYW4gY2xhc3M9XCJrY1wiPicgKyBwcmljZVtrZXlOdW1dLnBfY2sgKyAnPC9zcGFuPjwvcD48L3RkPic7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgaHRtbCArPSAnPHRkPjwvdGQ+JztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBodG1sICs9ICc8L3RyPic7XHJcbiAgICB9XHJcblxyXG4gICAgJCgnI3ByaWNlRGF5JykuaHRtbChodG1sKTtcclxuICAgIHByaWNlTW9udGgudGV4dChtKTtcclxuICAgIHByaWNlWWVhci50ZXh0KHkpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBwYWdlUmVuZGVyKGRhdGEpIHtcclxuXHJcbiAgICB2YXIgaW1nID0gZGF0YS50X3RpY2tfZmlsZSxcclxuICAgICAgICBsZW4gPSBpbWcubGVuZ3RoLFxyXG4gICAgICAgIGh0bWwgPSAnJztcclxuXHJcbiAgICBwaWNTaG93LmNzcygnYmFja2dyb3VuZCcsICd1cmwoJyArIGRhdGEudF90aWNrX2ZpbGVbMF0uc3JjICsgJykgY2VudGVyIG5vLXJlcGVhdCcpO1xyXG5cclxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuOyBpKyspIHtcclxuICAgICAgICBodG1sICs9ICc8bGkgY2xhc3M9XCJwaWMtaXRlbVwiPjxpbWcgY2xhc3M9XCJpdGVtLXBpY1wiIHNyYz0nICsgaW1nW2ldLnNyYyArICc+PC9saT4nO1xyXG4gICAgfVxyXG4gICAgJCgnI3BpY0xpc3QnKS5odG1sKGh0bWwpO1xyXG5cclxuICAgIC8v6ZSA6YePXHJcbiAgICAkKCcjc2FsZXMnKS5odG1sKCfplIDph486ICcgKyBkYXRhLnRfdGlja19zZWxsKTtcclxuXHJcbiAgICB2YXIgcHJldk1vbnRoQnRuID0gJCgnI3ByZXZNb250aEJ0bicpLFxyXG4gICAgICAgIG5leHRNb250aEJ0biA9ICQoJyNuZXh0TW9udGhCdG4nKTtcclxuXHJcbiAgICAvL+WVhuWTgeWTgeexu1xyXG4gICAgJCgnI3Byb0NpdHknKS5odG1sKGRhdGEudF90aWNrX2NpdHkpO1xyXG4gICAgLy/llYblk4FJRFxyXG4gICAgJCgnI3Byb0lEJykuaHRtbChkYXRhLnRfY29kZSk7XHJcbiAgICAvL+S6p+WTgeWQjeWtl1xyXG4gICAgJCgnI3Byb05hbWUnKS50ZXh0KGRhdGEudF90aWNrX25hbWUgKyAnKycgKyBkYXRhLnRfdGlja19jYXQgKyAnKycgKyBkYXRhLnRfdGlja19zcG90KTtcclxuXHJcblxyXG4gICAgLy/kuIrkuKrmnIhcclxuICAgIHByZXZNb250aEJ0bi5jbGljayhmdW5jdGlvbiAoZSkge1xyXG5cclxuICAgICAgICBpZiAocHJpY2VOdW0gPT0gMCkge1xyXG4gICAgICAgICAgICAkKHRoaXMpLmNzcygnYmFja2dyb3VuZCcsICcjY2VjZWNlJyk7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIG5leHRNb250aEJ0bi5jc3MoJ2JhY2tncm91bmQnLCAnIzMzODVmZicpO1xyXG5cclxuICAgICAgICBtb250aCAtPSAxO1xyXG5cclxuICAgICAgICBpZiAobW9udGggPT0gMCkge1xyXG4gICAgICAgICAgICBtb250aCA9IDEyO1xyXG4gICAgICAgICAgICB5ZWFyIC09IDE7XHJcbiAgICAgICAgfTtcclxuICAgICAgICBnZXREYXRlUHJpY2UobW9udGgsIHllYXIsIHByaWNlRGF0YVtwcmljZU51bSAtIDFdKTtcclxuXHJcbiAgICAgICAgcHJpY2VOdW0tLTtcclxuXHJcbiAgICAgICAgaWYgKHByaWNlTnVtID09IDApIHtcclxuICAgICAgICAgICAgJCh0aGlzKS5jc3MoJ2JhY2tncm91bmQnLCAnI2NlY2VjZScpO1xyXG4gICAgICAgIH1cclxuICAgIH0pLmJpbmQoXCJzZWxlY3RzdGFydFwiLCBmdW5jdGlvbiAoKSB7IHJldHVybiBmYWxzZTsgfSk7XHJcblxyXG4gICAgLy/kuIvkuKrmnIhcclxuICAgIG5leHRNb250aEJ0bi5jbGljayhmdW5jdGlvbiAoZSkge1xyXG5cclxuICAgICAgICBpZiAocHJpY2VOdW0gPT0gcHJpY2VMZW4gLSAxKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHByZXZNb250aEJ0bi5jc3MoJ2JhY2tncm91bmQnLCAnIzMzODVmZicpO1xyXG5cclxuICAgICAgICBtb250aCArPSAxO1xyXG5cclxuICAgICAgICBpZiAobW9udGggPT0gMTMpIHtcclxuICAgICAgICAgICAgbW9udGggPSAxO1xyXG4gICAgICAgICAgICB5ZWFyICs9IDE7XHJcbiAgICAgICAgfTtcclxuICAgICAgICBnZXREYXRlUHJpY2UobW9udGgsIHllYXIsIHByaWNlRGF0YVtwcmljZU51bSArIDFdKTtcclxuXHJcbiAgICAgICAgcHJpY2VOdW0rKztcclxuXHJcbiAgICAgICAgaWYgKHByaWNlTnVtID09IHByaWNlTGVuIC0gMSkge1xyXG4gICAgICAgICAgICAkKHRoaXMpLmNzcygnYmFja2dyb3VuZCcsICcjY2VjZWNlJyk7XHJcbiAgICAgICAgfVxyXG4gICAgfSkuYmluZChcInNlbGVjdHN0YXJ0XCIsIGZ1bmN0aW9uICgpIHsgcmV0dXJuIGZhbHNlOyB9KTtcclxuXHJcblxyXG4gICAgLy/otLnnlKjor7TmmI5cclxuICAgIHZhciBmeUh0bWwgPSAnPHAgY2xhc3M9XCJtYWluLXRpdGxlXCI+6LS555So5YyF5ZCrPHA+JztcclxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZGF0YS50X3RpY2tfY29zdC5sZW5ndGg7IGkrKykge1xyXG5cclxuICAgICAgICBmeUh0bWwgKz0gJzxwPjxzcGFuIGNsYXNzPVwi6LS555So5YyF5ZCrXCI+PC9zcGFuPicgK1xyXG4gICAgICAgICAgICAnPHNwYW4gY2xhc3M9XCJ0aXRsZVwiPicgKyBkYXRhLnRfdGlja19jb3N0W2ldLm5hbWUgKyAnIDogPC9zcGFuPjxzcGFuPicgKyBkYXRhLnRfdGlja19jb3N0W2ldLm51bSArIGRhdGEudF90aWNrX2Nvc3RbaV0uZGFud2VpICsgJyAsIOWNleasoeaXtumVvycgKyBkYXRhLnRfdGlja19jb3N0W2ldLmR1cmF0aW9uICsgJzwvc3Bhbj4nO1xyXG5cclxuICAgIH1cclxuICAgIGZ5SHRtbCArPSAnPC9wPic7XHJcblxyXG4gICAgaWYgKGRhdGEudF9hbm90aGVyX2Nvc3QpIHtcclxuICAgICAgICBmeUh0bWwgKz0gJzxwPjxzcGFuIGNsYXNzPVwidGl0bGVcIj7otLnnlKjljIXlkKvooaXlhYXor7TmmI4gOiA8L3NwYW4+PHNwYW4+JyArIGRhdGEudF9hbm90aGVyX2Nvc3QgKyAnPC9zcGFuPjwvcD4nO1xyXG4gICAgfVxyXG5cclxuICAgIGlmIChkYXRhLnRfdGlja19pbnN1cmFuY2UgIT0gJzAnKSB7XHJcbiAgICAgICAgZnlIdG1sICs9ICc8cD48c3BhbiBjbGFzcz1cInRpdGxlXCI+5L+d6ZmpIDogPC9zcGFuPjxzcGFuPuWMheWQqzwvc3Bhbj48L3A+JztcclxuICAgIH1cclxuXHJcbiAgICBmeUh0bWwgKz0gJzxwIGNsYXNzPVwibWFpbi10aXRsZVwiPui0ueeUqOS4jeWMheWQqzxwPic7XHJcblxyXG4gICAgaWYgKGRhdGEudF90aWNrX25vX2NvbnRhaW4pIHtcclxuICAgICAgICBmeUh0bWwgKz0gJzxwPjxzcGFuIGNsYXNzPVwidGl0bGVcIj7otLnnlKjkuI3ljIXlkKsgOiA8L3NwYW4+PHNwYW4+JyArIGRhdGEudF90aWNrX25vX2NvbnRhaW4gKyAnPC9zcGFuPjwvcD4nO1xyXG4gICAgfVxyXG5cclxuICAgIGlmIChkYXRhLnRfdGlja19pbnN1cmFuY2UgPT0gJzAnKSB7XHJcbiAgICAgICAgZnlIdG1sICs9ICc8cD48c3BhbiBjbGFzcz1cInRpdGxlXCI+5L+d6ZmpIDogPC9zcGFuPjxzcGFuPuS4jeWMheWQqzwvc3Bhbj48L3A+JztcclxuICAgIH1cclxuXHJcbiAgICAkKCcjZmVpeW9uZ0NvbnRlbnQnKS5odG1sKGZ5SHRtbCk7XHJcblxyXG4gICAgdmFyIHlkSHRtbCA9ICcnO1xyXG5cclxuICAgIGlmIChkYXRhLnRfdGlja19tb2JpbGUgPT0gJzEnKSB7XHJcbiAgICAgICAgeWRIdG1sICs9ICc8cD48c3BhbiBjbGFzcz1cInRpdGxlXCI+6IGU57O75Lq65L+h5oGvIDogPC9zcGFuPumcgOimgTwvcD4nO1xyXG4gICAgfVxyXG5cclxuICAgIGlmIChkYXRhLnRfdGlja19wbGF5ZXJJbmZvLnZhbCA9PSAnMScpIHtcclxuICAgICAgICB5ZEh0bWwgKz0gJzxwPjxzcGFuIGNsYXNzPVwidGl0bGVcIj7muLjnjqnkurrkv6Hmga8gOiA8L3NwYW4+5Y+q6ZyA6KaBMeS9jea4uOeOqeS6uuS/oeaBrzwvcD4nO1xyXG4gICAgfSBlbHNlIGlmIChkYXRhLnRfdGlja19wbGF5ZXJJbmZvLnZhbCA9PSAnMicpIHtcclxuICAgICAgICB5ZEh0bWwgKz0gJzxwPjxzcGFuIGNsYXNzPVwidGl0bGVcIj7muLjnjqnkurrkv6Hmga8gOiA8L3NwYW4+6ZyA6KaB5YWo6YOo5ri4546p5Lq65L+h5oGvPC9wPic7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKGRhdGEudF90aWNrX3ByZV9ib29rX3RpbWUudmFsID09ICcxJykge1xyXG4gICAgICAgIHlkSHRtbCArPSAnPHA+PHNwYW4gY2xhc3M9XCJ0aXRsZVwiPuaPkOWJjei0reS5sOaXtumXtCA6IDwvc3Bhbj48c3Bhbj7nlKjmiLfpnIDmj5DliY0nICsgZGF0YS50X3RpY2tfcHJlX2Jvb2tfdGltZS50d28uaG91ci52YWwgKyAn5bCP5pe2JyArIGRhdGEudF90aWNrX3ByZV9ib29rX3RpbWUudHdvLm1pbnV0ZS52YWwgKyAn5YiG6aKE5a6aPC9zcGFuPjwvcD4nO1xyXG4gICAgfSBlbHNlIGlmIChkYXRhLnRfdGlja19wcmVfYm9va190aW1lLnZhbCA9PSAnMicpIHtcclxuICAgICAgICB5ZEh0bWwgKz0gJzxwPjxzcGFuIGNsYXNzPVwidGl0bGVcIj7mj5DliY3otK3kubDml7bpl7QgOiA8L3NwYW4+PHNwYW4+55So5oi36ZyA5Zyo5ri4546pJyArIGRhdGEudF90aWNrX3ByZV9ib29rX3RpbWUudGhyZWUuZGF5LnZhbCArIGRhdGEudF90aWNrX3ByZV9ib29rX3RpbWUudGhyZWUuaG91ci52YWwgKyAn54K5JyArIGRhdGEudF90aWNrX3ByZV9ib29rX3RpbWUudGhyZWUubWludXRlICsgJ+WIhumihOWumjwvc3Bhbj48L3A+J1xyXG4gICAgfVxyXG5cclxuICAgIGlmIChkYXRhLnRfeWRfbnVtKSB7XHJcbiAgICAgICAgeWRIdG1sICs9ICc8cD48c3BhbiBjbGFzcz1cInRpdGxlXCI+6aKE5a6a5pWw6YeP6ZmQ5Yi2IDogPC9zcGFuPuavj+eslOiuouWNleacgOWwkei0reS5sCcgKyBkYXRhLnRfeWRfbnVtLm1pbiArICflvKAnO1xyXG5cclxuICAgICAgICBpZiAoZGF0YS50X3lkX251bS5tYXgpIHtcclxuICAgICAgICAgICAgeWRIdG1sICs9ICcs5pyA5aSn6LSt5LmwJyArIGRhdGEudF95ZF9udW0ubWF4ICsgJ+W8oDwvcD4nO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHlkSHRtbCArPSAnPC9wPic7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGlmIChkYXRhLnRfdGlja19pZGVudGl0eS5tYXhOdW0pIHtcclxuICAgICAgICB5ZEh0bWwgKz0gJzxwPjxzcGFuIGNsYXNzPVwidGl0bGVcIj7ouqvku73or4HpmZDliLYgOiA8L3NwYW4+5ZCM5LiA6Lqr5Lu96K+B5ZyoJyArIG1pbkRheSArICflpKnlhoXmnIDlpJrotK3kubAnICsgbWF4TnVtICsgJ+W8oDwvcD4nO1xyXG4gICAgfVxyXG5cclxuICAgIGlmIChkYXRhLnRfZ29fYl90aW1lWzBdLmZyb21IKSB7XHJcbiAgICAgICAgeWRIdG1sICs9ICc8cD48c3BhbiBjbGFzcz1cInRpdGxlXCI+5YWl5Zut5pe26Ze0IDogPC9zcGFuPicgKyBkYXRhLnRfZ29fYl90aW1lWzBdLmZyb21IICsgJzonICsgZGF0YS50X2dvX2JfdGltZVswXS5mcm9tTSArICd+JyArIGRhdGEudF9nb19iX3RpbWVbMF0udG9IICsgJzonICsgZGF0YS50X2dvX2JfdGltZVswXS50b007XHJcbiAgICAgICAgaWYgKGRhdGEudF9nb19iX3RpbWVbMF0uYmNJbmZvLnZhbCkge1xyXG4gICAgICAgICAgICB5ZEh0bWwgKz0gJyA8c3Bhbj4gJyArIGRhdGEudF9nb19iX3RpbWVbMF0uYmNJbmZvLnZhbCArICc8L3NwYW4+JztcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB5ZEh0bWwgKz0gJzwvcD4nO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBpZiAoZGF0YS50X3RpY2tfdXNlX2FkZHJlc3MpIHtcclxuICAgICAgICB5ZEh0bWwgKz0gJzxwPjxzcGFuIGNsYXNzPVwidGl0bGVcIj7lhaXlm63lnLDlnYAgOiA8L3NwYW4+JztcclxuXHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBkYXRhLnRfdGlja191c2VfYWRkcmVzcy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICB5ZEh0bWwgKz0gJzxzcGFuPicgKyBkYXRhLnRfdGlja191c2VfYWRkcmVzc1tpXS52YWwgKyAnIDwvc3Bhbj4nO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgeWRIdG1sICs9ICc8L3A+JztcclxuICAgIH1cclxuXHJcbiAgICBpZiAoZGF0YS50X3RpY2tfZGF0ZSA9PSAnMScpIHtcclxuICAgICAgICB5ZEh0bWwgKz0gJzxwPjxzcGFuIGNsYXNzPVwidGl0bGVcIj7mnInmlYjmnJ/mqKHlvI8gOiA8L3NwYW4+5q2k6Zeo56Wo5peg6ZyA55So5oi35oyH5a6a5L2/55So5pel5pyfPC9wPic7XHJcblxyXG4gICAgICAgIHlkSHRtbCArPSAnPHA+PHNwYW4gY2xhc3M9XCJ0aXRsZVwiPuacieaViOacnyA6IDwvc3Bhbj48c3Bhbj4nICsgZGF0YS50X3RpY2tfdmVyaWZ5X3RpbWUgKyAnficgKyBkYXRhLnRfdGlja194al90aW1lICsgJzwvc3Bhbj48L3A+JztcclxuICAgIH1cclxuXHJcbiAgICBpZiAoZGF0YS51c2VfdGltZSkge1xyXG5cclxuICAgICAgICB5ZEh0bWwgKz0gJzxwPjxzcGFuIGNsYXNzPVwidGl0bGVcIj7lj6/nlKjml6XmnJ8gOjwvc3Bhbj4nO1xyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZGF0YS51c2VfdGltZS5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICBpZiAoZGF0YS51c2VfdGltZVtpXSA9PSAndHJ1ZScpIHtcclxuICAgICAgICAgICAgICAgIHlkSHRtbCArPSAnPHNwYW4+ICcgKyBkYXRlSnNvbltpXSArICcgPC9zcGFuPic7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKGRhdGEubm9fdXNlX3RpbWUpIHtcclxuICAgICAgICB5ZEh0bWwgKz0gJzxwPjxzcGFuIGNsYXNzPVwidGl0bGVcIj7kuI3lj6/nlKjml6XmnJ8gOjwvc3Bhbj4nO1xyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZGF0YS5ub191c2VfdGltZS5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICB5ZEh0bWwgKz0gJzxzcGFuPiAnICsgZGF0YS5ub191c2VfdGltZVtpXSArICcgPC9zcGFuPic7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgICQoJyN5dWRpbmdDb250ZW50JykuaHRtbCh5ZEh0bWwpO1xyXG59XHJcblxyXG52YXIgcHJvUHJpY2UgPSAkKCcjcHJvUHJpY2UnKSxcclxuICAgIE5VTSA9ICQoJyNudW0nKSxcclxuICAgIFBSSUNFLCAgICAvL+S7t+agvFxyXG4gICAgS0MsICAgICAgIC8v5bqT5a2YXHJcbiAgICBudW1WYWwgPSAxOyAgIC8v5pWw6YePXHJcbi8v5aKe5YqgXHJcbiQoJyNjaG9vc2VOdW0nKS5vbignY2xpY2snLCAnLmFkZCcsIGZ1bmN0aW9uICgpIHtcclxuICAgIFxyXG4gICAgdmFyIHByaWNlID0gcHJvUHJpY2UudGV4dCgpO1xyXG5cclxuICAgIGlmKHByaWNlID09ICctLScpe1xyXG4gICAgICAgIGFsZXJ0KCfor7flhYjpgInmi6nlh7rmuLjml6XmnJ8nKTtcclxuICAgIH1lbHNle1xyXG4gICAgICAgIHZhciBudW0gPSAkKHRoaXMpLnBhcmVudHMoJy5hbW91bnQnKS5maW5kKCcubnVtJyk7XHJcbiAgICAgICAgbnVtVmFsID0gK251bS50ZXh0KCk7XHJcblxyXG4gICAgICAgIGlmKG51bVZhbCA9PSBLQyl7XHJcbiAgICAgICAgICAgIEFsZXJ0KCflt7Lovr7liLDlupPlrZjkuIrpmZAnKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIG51bVZhbCArPSAxO1xyXG4gICAgICAgIG51bS50ZXh0KG51bVZhbCk7XHJcblxyXG4gICAgICAgIHByaWNlID0gK1BSSUNFICogMTAwO1xyXG4gICAgICAgIHByb1ByaWNlLnRleHQobnVtVmFsICogcHJpY2UgLyAxMDApO1xyXG4gICAgfVxyXG5cclxufSkuYmluZChcInNlbGVjdHN0YXJ0XCIsIGZ1bmN0aW9uICgpIHsgcmV0dXJuIGZhbHNlOyB9KTtcclxuXHJcbiQoJyNjaG9vc2VOdW0nKS5vbignY2xpY2snLCAnLnJlZCcsIGZ1bmN0aW9uICgpIHtcclxuICAgIFxyXG4gICAgdmFyIHByaWNlID0gcHJvUHJpY2UudGV4dCgpO1xyXG5cclxuICAgIGlmKHByaWNlID09ICctLScpe1xyXG4gICAgICAgIGFsZXJ0KCfor7flhYjpgInmi6nlh7rmuLjml6XmnJ8nKTtcclxuICAgIH1lbHNle1xyXG4gICAgICAgIHZhciBudW0gPSAkKHRoaXMpLnBhcmVudHMoJy5hbW91bnQnKS5maW5kKCcubnVtJyk7XHJcbiAgICAgICAgbnVtVmFsID0gK251bS50ZXh0KCk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgaWYobnVtVmFsID09IDEpe1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBudW1WYWwgLT0gMTtcclxuICAgICAgICBudW0udGV4dChudW1WYWwpO1xyXG5cclxuICAgICAgICBwcmljZSA9ICtQUklDRSAqIDEwMDtcclxuICAgICAgICBwcm9QcmljZS50ZXh0KG51bVZhbCAqIHByaWNlIC8gMTAwKTtcclxuICAgIH1cclxuXHJcbn0pLmJpbmQoXCJzZWxlY3RzdGFydFwiLCBmdW5jdGlvbiAoKSB7IHJldHVybiBmYWxzZTsgfSk7XHJcblxyXG52YXIgbm93RGF0ZSA9IG5ldyBEYXRlKCksXHJcbiAgICB5ZWFyID0gbm93RGF0ZS5nZXRGdWxsWWVhcigpLFxyXG4gICAgbW9udGggPSBub3dEYXRlLmdldE1vbnRoKCkgKyAxLFxyXG4gICAgcHJpY2VNb250aCA9ICQoJyNwcmljZU1vbnRoJyksXHJcbiAgICBwcmljZVllYXIgPSAkKCcjcHJpY2VZZWFyJyksXHJcbiAgICBwaWNTaG93ID0gJCgnI3BpY1Nob3cnKSxcclxuICAgIHByaWNlRGF0YSxcclxuICAgIHByaWNlTGVuLFxyXG4gICAgcHJpY2VOdW0gPSAwLFxyXG4gICAgbmFtZSxcclxuICAgIHVzZXJJZCxcclxuICAgIG1lc3MsICAgICAvLyA9MiDpnIDopoHlhajpg6jmuLjlrqLkv6Hmga9cclxuICAgIG9uZUlkZW50aWZ5LFxyXG4gICAgdXNlRGF0ZTsgICAvL+aYr+WQpuaYr+acieaViOacn+aooeW8j1xyXG5cclxudmFyIHR5cGUgPSB1cmxLZXkoJ3R5cGUnKSxcclxuICAgIGNvZGUgPSB1cmxLZXkoJ2NvZGUnKSxcclxuICAgIFVSTCA9ICdodHRwOi8vd3d3LnN1aXlpeW91Lm5ldC9pbmRleC5waHAvV2VpeGluL0RldGFpbC9kZXRhaWwnO1xyXG5cclxuJC5hamF4KHtcclxuICAgIHVybDogVVJMLFxyXG4gICAgZGF0YToge1xyXG4gICAgICAgIHR5cGU6IHR5cGUsXHJcbiAgICAgICAgY29kZTogY29kZVxyXG4gICAgfSxcclxuICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uIChyZXMpIHtcclxuXHJcbiAgICAgICAgdmFyIGRhdGEgPSByZXMuZGF0YTtcclxuICAgICAgICBuYW1lID0gZGF0YS50X3RpY2tfbmFtZSArICcrJyArIGRhdGEudF90aWNrX2NhdCArICcrJyArIGRhdGEudF90aWNrX3Nwb3Q7XHJcbiAgICAgICAgdXNlcklkID0gZGF0YS50X3VzZXJfaWQ7XHJcbiAgICAgICAgcHJpY2VEYXRhID0gcmVzLmRhdGEuZGF0ZTtcclxuICAgICAgICBwcmljZUxlbiA9IHByaWNlRGF0YS5sZW5ndGg7XHJcbiAgICAgICAgbWVzcyA9IGRhdGEudF90aWNrX3BsYXllckluZm8udmFsOyAvL+WFtuS7lua4uOWuoui6q+S7veaVsOe7hFxyXG4gICAgICAgIG9uZUlkZW50aWZ5ID0gZGF0YS50X3RpY2tfbW9iaWxlOyAgLy/pnIDopoHkuIDkuKrouqvku73kv6Hmga8xIOS4jemcgOimgTBcclxuICAgICAgICBpZiAoZGF0YS50X3RpY2tfZGF0ZSA9PSAnMScpIHsgICAgICAgLy/lpoLmnpzmmK/mnInmlYjmnJ/mqKHlvI9cclxuICAgICAgICAgICAgdXNlRGF0ZSA9IHtcclxuICAgICAgICAgICAgICAgIHVzZTogZGF0YS50X3RpY2tfZGF0ZSxcclxuICAgICAgICAgICAgICAgIGxpbWl0OiBkYXRhLnRfdGlja192ZXJpZnlfdGltZSArICd+JyArIGRhdGEudF90aWNrX3hqX3RpbWUsXHJcbiAgICAgICAgICAgICAgICB0aW1lOiBkYXRhLnVzZV90aW1lXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIGlmIChkYXRhLm5vX3VzZV90aW1lKSB7XHJcbiAgICAgICAgICAgICAgICB1c2VEYXRlLm5vID0gZGF0YS5ub191c2VfdGltZVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGdldERhdGVQcmljZShtb250aCwgeWVhciwgcHJpY2VEYXRhWzBdKTsgIC8v5Lu35qC85pel5Y6GXHJcbiAgICAgICAgcGFnZVJlbmRlcihkYXRhKTtcclxuICAgIH1cclxufSlcclxuXHJcblxyXG4kKCcjcGljTGlzdCcpLm9uKCdtb3VzZW92ZXInLCAnLnBpYy1pdGVtJywgZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIHNyYyA9ICQodGhpcykuZmluZCgnLml0ZW0tcGljJykuYXR0cignc3JjJyk7XHJcbiAgICBwaWNTaG93LmNzcygnYmFja2dyb3VuZCcsICd1cmwoJyArIHNyYyArICcpIGNlbnRlciBuby1yZXBlYXQnKTtcclxufSlcclxuXHJcblxyXG4vL+S7t+agvOaXpeWOhumAieaLqVxyXG52YXIgcHJpY2VCb3ggPSAkKCcjcHJvUHJpY2UnKSxcclxuICAgIGdvVGltZSA9ICQoJyNnb1RpbWUnKTtcclxuXHJcbiQoJyNwcmljZURheScpLm9uKCdjbGljaycsICcuanNfY2hvb3NlJywgZnVuY3Rpb24gKCkge1xyXG4gICAgJCgnLmpzX2Nob29zZScpLnJlbW92ZUNsYXNzKCdvbicpO1xyXG4gICAgJCh0aGlzKS5hZGRDbGFzcygnb24nKTtcclxuXHJcbiAgICB2YXIgcHJpY2UgPSAkKHRoaXMpLmZpbmQoJy50aWNrZXQtcHJpJykudGV4dCgpO1xyXG4gICAgcHJpY2VCb3gudGV4dChwcmljZSk7XHJcbiAgICBQUklDRSA9ICtwcmljZTtcclxuICAgIHByb1ByaWNlLnRleHQoUFJJQ0UgKiArTlVNLnRleHQoKSk7XHJcblxyXG4gICAgS0MgPSArJCh0aGlzKS5maW5kKCcuZGF0ZS1rYycpLnRleHQoKTtcclxuXHJcbiAgICB2YXIgZ290aW1lID0gJCh0aGlzKS5hdHRyKCdkYXRhLWdvdGltZScpO1xyXG4gICAgZ29UaW1lLnRleHQoZ290aW1lKTtcclxuXHJcbn0pXHJcblxyXG5cclxuLy/nq4vljbPotK3kubBcclxuJCgnI25vd0J1eScpLmNsaWNrKGZ1bmN0aW9uICgpIHtcclxuICAgIGxvZ2luQ29uZmlybSgpO1xyXG59KVxyXG5cclxuZnVuY3Rpb24gbG9naW5Db25maXJtKCkge1xyXG4gICAgaWYgKCQoJyNwcm9QcmljZScpLnRleHQoKSA9PSAnLS0nKSB7XHJcbiAgICAgICAgYWxlcnQoJ+ivt+WFiOS7juS7t+agvOaXpeWOhumAieaLqeaXpeacnycpO1xyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgY29kZSA9IHVybEtleSgnY29kZScpO1xyXG4gICAgICAgIHR5cGUgPSB1cmxLZXkoJ3R5cGUnKTtcclxuXHJcbiAgICAgICAgc2V0Q29va2llKCdwcmljZScsICQoJyNwcm9QcmljZScpLnRleHQoKSwgMzAgKiA2MCAqIDEwMDApOyAgLy/ku7fmoLxcclxuICAgICAgICBpZiAodXNlRGF0ZSkge1xyXG4gICAgICAgICAgICBzZXRDb29raWUoJ3VzZScsIEpTT04uc3RyaW5naWZ5KHVzZURhdGUpLCAzMCAqIDYwICogMTAwMCk7ICAgICAvL+acieaViOacn+aooeW8j1xyXG4gICAgICAgIH1cclxuICAgICAgICBzZXRDb29raWUoJ2RhdGUnLCAkKCcjZ29UaW1lJykudGV4dCgpLCAzMCAqIDYwICogMTAwMCk7ICAgIC8v5Ye66KGM5pe26Ze0XHJcbiAgICAgICAgc2V0Q29va2llKCd1c2VyJywgdXNlcklkLCAzMCAqIDYwICogMTAwMCk7ICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgc2V0Q29va2llKCdtZXNzJywgbWVzcywgMzAgKiA2MCAqIDEwMDApOyAgICAgICAgICAgICAgICAgICAgLy/mmK/lkKbpnIDopoHouqvku73or4FcclxuICAgICAgICBzZXRDb29raWUoJ251bScsIG51bVZhbCwgMzAgKiA2MCAqIDEwMDApO1xyXG4gICAgICAgIHNldENvb2tpZSgncGljJywgJCgnLml0ZW0tcGljJykuZXEoMCkuYXR0cignc3JjJyksIDMwICogNjAgKiAxMDAwKTsgIC8v5Zu+54mH6aaW5Zu+XHJcbiAgICAgICAgSFJFRiA9IGNvbnRyb2xsZXIgKyAnL2RfdGlja2V0P2NvZGU9JyArIGNvZGUgKyAnJnR5cGU9JyArIHR5cGU7XHJcblxyXG4gICAgICAgIGxvY2F0aW9uLmhyZWYgPSBIUkVGO1xyXG4gICAgICAgIHNldENvb2tpZSgnbmFtZScsIG5hbWUsIDMwICogNjAgKiAxMDAwKTsgIC8v5Lqn5ZOB5ZCN5a2XXHJcbiAgICB9XHJcbiAgICAvLyAkLmFqYXgoe1xyXG4gICAgLy8gICAgIHVybDogJ2h0dHA6Ly93d3cuc3VpeWl5b3UubmV0L2luZGV4LnBocC9XZWl4aW4vQmFzZUxvZ2luL2xvZ2luZWQnLFxyXG4gICAgLy8gICAgIHR5cGU6ICdQT1NUJyxcclxuICAgIC8vICAgICBzdWNjZXNzOiBmdW5jdGlvbiAocmVzKSB7XHJcbiAgICAvLyAgICAgICAgIHZhciBjb2RlID0gcmVzLmNvZGU7XHJcbiAgICAvLyAgICAgICAgIC8vIGlmIChjb2RlID09IDIwMCkge1xyXG5cclxuICAgIC8vICAgICAgICAgY29kZSA9IHVybEtleSgnY29kZScpO1xyXG4gICAgLy8gICAgICAgICB0eXBlID0gdXJsS2V5KCd0eXBlJyk7XHJcbiAgICAvLyAgICAgICAgIHZhciBjaG9vc2VPbiA9ICQoJy5qc19jaG9vc2Uub24nKSxcclxuICAgIC8vICAgICAgICAgICAgIGtjID0gY2hvb3NlT24uZmluZCgnLmtjJykudGV4dCgpO1xyXG5cclxuICAgIC8vICAgICAgICAgc2V0Q29va2llKCdwcmljZScsICQoJyNwcm9QcmljZScpLnRleHQoKSwgMzAgKiA2MCAqIDEwMDApOyAgLy/ku7fmoLxcclxuICAgIC8vICAgICAgICAgaWYgKHVzZURhdGUpIHtcclxuICAgIC8vICAgICAgICAgICAgIHNldENvb2tpZSgndXNlJywgSlNPTi5zdHJpbmdpZnkodXNlRGF0ZSksIDMwICogNjAgKiAxMDAwKTsgICAgIC8v5pyJ5pWI5pyf5qih5byPXHJcbiAgICAvLyAgICAgICAgIH1cclxuICAgIC8vICAgICAgICAgc2V0Q29va2llKCdkYXRlJywgJCgnI2dvVGltZScpLnRleHQoKSwgMzAgKiA2MCAqIDEwMDApO1xyXG4gICAgLy8gICAgICAgICBzZXRDb29raWUoJ3VzZXInLCB1c2VySWQsIDMwICogNjAgKiAxMDAwKTtcclxuICAgIC8vICAgICAgICAgc2V0Q29va2llKCdtZXNzJywgbWVzcywgMzAgKiA2MCAqIDEwMDApO1xyXG4gICAgLy8gICAgICAgICBIUkVGID0gY29udHJvbGxlciArICcvZF90aWNrZXQ/Y29kZT0nICsgY29kZSArICcmdHlwZT0nICsgdHlwZTtcclxuXHJcbiAgICAvLyAgICAgICAgIGxvY2F0aW9uLmhyZWYgPSBIUkVGO1xyXG4gICAgLy8gICAgICAgICBzZXRDb29raWUoJ25hbWUnLCBuYW1lLCAzMCAqIDYwICogMTAwMCk7ICAvL+S6p+WTgeWQjeWtl1xyXG5cclxuICAgIC8vICAgICAgICAgLy8gfSBlbHNlIHtcclxuICAgIC8vICAgICAgICAgLy8gbG9jYXRpb24uaHJlZiA9IGNvbnRyb2xsZXIgKyAnL3JlZ2lzdGVyJzsgICAgIC8v5pyq5rOo5YaM6Lez6L2s5rOo5YaMXHJcbiAgICAvLyAgICAgICAgIC8vIH1cclxuICAgIC8vICAgICB9XHJcbiAgICAvLyB9KVxyXG59XHJcblxyXG5cclxuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9zcmMvcF90aWNrZXQvaW5kZXguanNcbi8vIG1vZHVsZSBpZCA9IDBcbi8vIG1vZHVsZSBjaHVua3MgPSAwIDEiLCIvLyByZW1vdmVkIGJ5IGV4dHJhY3QtdGV4dC13ZWJwYWNrLXBsdWdpblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vc3JjL3BfdGlja2V0L2luZGV4LnNjc3Ncbi8vIG1vZHVsZSBpZCA9IDFcbi8vIG1vZHVsZSBjaHVua3MgPSAwIDEiLCJ2YXIgZGF0ZVByaWNlID0ge1xuXG4gICAgZ2V0TW9udGhGaXJzdERheSA6IGZ1bmN0aW9uKG0sIHkpIHtcbiAgICAgICAgdmFyIGQgPSBuZXcgRGF0ZSh5LCBtLCAxKTtcbiAgICAgICAgcmV0dXJuIGQuZ2V0RGF5KCk7XG4gICAgfSxcblxuICAgIGdldE1vbnRoVG90YWxEYXRlIDogZnVuY3Rpb24obSwgeSkge1xuICAgICAgICB2YXIgZCA9IG5ldyBEYXRlKHksIG0sIDApO1xuICAgICAgICByZXR1cm4gZC5nZXREYXRlKCk7XG4gICAgfSxcblxuICAgIGdldEZyb21Ub2RheURheXMgOiBmdW5jdGlvbihkLCBtLCB5KSB7XG4gICAgICAgIHZhciByZXQ7XG4gICAgICAgIHZhciB0ID0gbmV3IERhdGUoKTtcbiAgICAgICAgdmFyIHQxID0gbmV3IERhdGUoKTtcbiAgICAgICAgdC5zZXRGdWxsWWVhcih5KTtcbiAgICAgICAgdC5zZXRNb250aChtKTtcbiAgICAgICAgdC5zZXREYXRlKGQpO1xuICAgICAgICB2YXIgZGF5cyA9IE1hdGguZmxvb3IoKHQuZ2V0VGltZSgpIC0gdDEuZ2V0VGltZSgpKSAvICgyNCAqIDYwICogNjAgKiAxMDAwKSk7XG4gICAgICAgIHZhciByZXQgPSAn5LuK5aSpJztcbiAgICAgICAgaWYgKGRheXMgPT0gMCkge1xuICAgICAgICAgICAgcmV0ID0gJ+S7iuWkqSc7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoZGF5cyA9PSAxKSB7XG4gICAgICAgICAgICByZXQgPSAn5piO5aSpJztcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChkYXlzID09IDEpIHtcbiAgICAgICAgICAgIHJldCA9ICfmmKjlpKknO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGRheXMgPiAxKSB7XG4gICAgICAgICAgICByZXQgPSBkYXlzICsgJ+WkqeWQjic7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoZGF5cyA8IC0xKSB7XG4gICAgICAgICAgICByZXQgPSAwIC0gZGF5cyArICflpKnliY0nO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXQ7XG4gICAgfSxcblxuICAgIGRhdGFQcmljZUFyciA6IGZ1bmN0aW9uKG0sIHkpIHtcbiAgICAgICAgdmFyIHQgPSBuZXcgRGF0ZSgpO1xuICAgICAgICB2YXIgblNwYWNlID0gZGF0ZVByaWNlLmdldE1vbnRoRmlyc3REYXkobSAtIDEsIHkpO1xuICAgICAgICB2YXIgdG90YWxEYXRlID0gZGF0ZVByaWNlLmdldE1vbnRoVG90YWxEYXRlKG0sIHkpO1xuICAgICAgICB2YXIgcmV0ID0gW107XG4gICAgICAgIHZhciB0ckFycmF5ID0gW107XG4gICAgXG4gICAgICAgIGZvciAodmFyIGkgPSAxOyA7IGkrKykge1xuICAgICAgICAgICAgaWYgKGkgPD0gblNwYWNlKSB7XG4gICAgICAgICAgICAgICAgdHJBcnJheS5wdXNoKCcnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGkgPD0gdG90YWxEYXRlICsgblNwYWNlKSB7XG4gICAgXG4gICAgICAgICAgICAgICAgdHJBcnJheS5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgbnVtOiBpIC0gblNwYWNlLFxuICAgICAgICAgICAgICAgICAgICBpc1Nob3dEYXlJbmZvOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgaXNUb2RheTogKG0gPT0gdC5nZXRNb250aCgpICsgMSAmJiBpIC0gblNwYWNlID09IHQuZ2V0RGF0ZSgpICYmIHkgPT0gdC5nZXRGdWxsWWVhcigpKSA/IHRydWUgOiBmYWxzZSxcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHZhciBsID0gdHJBcnJheS5sZW5ndGg7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogKyBsIDwgNzsgaisrKSB7XG4gICAgICAgICAgICAgICAgICAgIHRyQXJyYXkucHVzaCgnJyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldC5wdXNoKHRyQXJyYXkpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRyQXJyYXkubGVuZ3RoID09IDcpIHtcbiAgICAgICAgICAgICAgICByZXQucHVzaCh0ckFycmF5KTtcbiAgICAgICAgICAgICAgICB0ckFycmF5ID0gW107XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJldDtcbiAgICB9XG59O1xuXG5pZiAodHlwZW9mIG1vZHVsZSAhPT0gJ3VuZGVmaW5lZCcgJiYgdHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnKSB7XG4gICAgbW9kdWxlLmV4cG9ydHMgPSBkYXRlUHJpY2UuZGF0YVByaWNlQXJyO1xufSBlbHNlIHtcbiAgICB3aW5kb3cuZGF0ZVByaWNlID0gZGF0ZVByaWNlLmRhdGFQcmljZUFycjtcbn1cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuLi9jb21tb24vZGF0ZS5qc1xuLy8gbW9kdWxlIGlkID0gMlxuLy8gbW9kdWxlIGNodW5rcyA9IDAgMSJdLCJzb3VyY2VSb290IjoiIn0=